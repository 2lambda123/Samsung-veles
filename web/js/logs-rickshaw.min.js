Rickshaw.Graph.HoverDetail.prototype.formatter=function(e,i,s,n,t,r){return e.name+(r.value.event?"  "+r.value.event:"")},Rickshaw.Graph.Legend.prototype.initialize=function(e){this.graph=e.graph,this.naturalOrder=e.naturalOrder,this.element=e.element;var i=$(this.element).addClass(this.className).find("#rickshaw-legend");if(this.list=i.get(0),void 0===this.list||e.force===!0){this.list=document.createElement("ul"),this.list.id="rickshaw-legend",this.element.appendChild(this.list),this.render(),$(this.lines[this.lines.length-1].element).css("visibility","hidden"),this.lines.length=this.lines.length-1,$(this.element).addClass(this.className).find("#rickshaw-legend").data("Rickshaw.Graph.Legend",this);for(var s in this.lines){var n=this.lines[s];n.series=[n.series]}this.graph_indices={},this.graph_indices[this.graph.element.id]=0,this.graphs=[this.graph]}else{var t=i.data("Rickshaw.Graph.Legend");this.lines=t.lines,this.graph_indices=t.graph_indices,this.graphs=t.graphs;var r=this.graph.series.map(function(e){return e});this.naturalOrder||(r=r.reverse());for(var s in this.lines){var n=this.lines[s];n.series.push(r[s])}this.graph_indices[this.graph.element.id]=Object.keys(this.graph_indices).length,this.graphs.push(this.graph)}this.graph.onUpdate(function(){})},Rickshaw.Graph.Behavior.Series.Toggle=function(e){this.legend=e.legend,this.graph=this.legend.graph;var i=this,s=i.legend.graph_indices[this.graph.element.id];if(this.addAnchor=function(e){var t=n(e.element).find("#rickshaw-legend-toggle").get(0);void 0===t&&(t=document.createElement("a"),t.innerHTML="&#10004;",t.classList.add("action"),t.id="rickshaw-legend-toggle",e.element.insertBefore(t,e.element.firstChild)),t.addEventListener("click",function(){if(e.series[s].disabled)e.series[s].enable(),e.element.classList.remove("disabled");else{if(this.graph.series.filter(function(e){return!e.disabled}).length<=1)return;e.series[s].disable(),e.element.classList.add("disabled")}i.graph.update()}.bind(this));var r=e.element.getElementsByTagName("span")[0];r.onclick=function(){var s=e.series[0].disabled;if(!s)for(var n=0;n<i.legend.lines.length;n++){var t=i.legend.lines[n];if(e.series===t.series);else if(!t.series[0].disabled){s=!0;break}}if(s){for(var r in e.series)e.series[r].enable();e.element.classList.remove("disabled"),i.legend.lines.forEach(function(i){if(e.series===i.series);else{for(var s in i.series)i.series[s].disable();i.element.classList.add("disabled")}})}else i.legend.lines.forEach(function(e){for(var i in e.series)e.series[i].enable();e.element.classList.remove("disabled")});for(r in i.legend.graphs)graphs[r].update()}},this.legend){var n=jQuery;"undefined"!=typeof n&&n(this.legend.list).sortable&&n(this.legend.list).sortable({start:function(e,i){i.item.bind("no.onclick",function(e){e.preventDefault()})},stop:function(e,i){setTimeout(function(){i.item.unbind("no.onclick")},250)}}),this.legend.lines.forEach(function(e){i.addAnchor(e)})}this._addBehavior=function(){this.graph.series.forEach(function(e){e.disable=function(){if(i.graph.series.length<=1)throw"only one series left";e.disabled=!0},e.enable=function(){e.disabled=!1}})},this._addBehavior(),this.updateBehaviour=function(){this._addBehavior()}},Rickshaw.Graph.Behavior.Series.Highlight=function(e){this.legend=e.legend,this.graph=this.legend.graph;var i=this,s={},n=null,t=i.legend.graph_indices[this.graph.element.id],r=e.disabledColor||function(e){return d3.interpolateRgb(e,d3.rgb("#d8d8d8"))(.8).toString()};this.addHighlightEvents=function(e){e.element.addEventListener("mouseover",function(){n||(n=e,i.legend.lines.forEach(function(n){if(e!==n)s[n.series[t].name]=s[n.series[t].name]||n.series[t].color,n.series[t].color=r(n.series[t].color);else if(i.graph.renderer.unstack&&(n.series[t].renderer?n.series[t].renderer.unstack:!0)){var a=i.graph.series.indexOf(n.series[t]);n.originalIndex=a;var l=i.graph.series.splice(a,1)[0];i.graph.series.push(l)}}),i.graph.update())},!1),e.element.addEventListener("mouseout",function(){n&&(n=null,i.legend.lines.forEach(function(n){if(e===n&&n.hasOwnProperty("originalIndex")){var r=i.graph.series.pop();i.graph.series.splice(n.originalIndex,0,r),delete n.originalIndex}s[n.series[t].name]&&(n.series[t].color=s[n.series[t].name])}),i.graph.update())},!1)},this.legend&&this.legend.lines.forEach(function(e){i.addHighlightEvents(e)})},Rickshaw.Graph.Behavior.Series.Order=function(e){this.legend=e.legend;var i=this;if("undefined"==typeof window.jQuery)throw"couldn't find jQuery at window.jQuery";if("undefined"==typeof window.jQuery.ui)throw"couldn't find jQuery UI at window.jQuery.ui";$(function(){$(i.legend.list).sortable({containment:"parent",tolerance:"pointer",update:function(){for(var e in i.legend.graphs){var s=[];$(i.legend.list).find("li").each(function(e,i){i.series&&s.push(i.series)});for(var n=i.legend.graphs[e],t=n.series.length-1;t>=0;t--)n.series[t]=s.shift();n.update()}}}),$(i.legend.list).disableSelection()}),this.legend.graph.onUpdate(function(){var e=window.getComputedStyle(i.legend.element).height;i.legend.element.style.height=e})};